---
import Layout from '../layouts/Layout.astro';
import ProfilePhoto from '../components/ProfilePhoto.astro';
import ModeToggle from '../components/ModeToggle.astro';
import About from '../components/About.astro';
import Posts from '../components/Posts.astro';
import Projects from '../components/Projects.astro';
import LanguageSwitcher from '../components/LanguageSwitcher.astro';
import { useTranslations } from '../i18n/utils';
import { getAllPosts } from '../data/posts';
import { getProjects } from '../data/projects';
import type { Locale } from '../i18n/utils';

const lang: Locale = 'en';
const t = useTranslations(lang);

const allPosts = getAllPosts(lang);
const professionalPosts = allPosts
  .filter(p => p.type === 'professional')
  .map(p => ({ title: p.title, slug: p.slug, date: p.date, readTime: p.readTime, pinned: p.pinned }));
const personalPosts = allPosts
  .filter(p => p.type === 'personal')
  .map(p => ({ title: p.title, slug: p.slug, date: p.date, readTime: p.readTime, pinned: p.pinned }));

const allProjects = getProjects(lang);
const professionalProjects = allProjects.filter(p => p.mode === 'professional');
const personalProjects = allProjects.filter(p => p.mode === 'personal');
---

<Layout title={t('siteTitle')} description={t('siteDescription')} lang={lang}>
  <!-- Header Navigation -->
  <header class="flex items-center w-full mb-8">
    <a href="/" class="text-muted-foreground hover:text-foreground transition-colors text-sm">
      {t('home')}
    </a>
    <div class="flex-1 flex justify-center">
      <ModeToggle lang={lang} />
    </div>
    <LanguageSwitcher lang={lang} />
  </header>

  <!-- Hero Section -->
  <section class="flex flex-col items-center gap-y-4">
    <ProfilePhoto
      professionalImage="/images/profile-professional.jpg"
      personalImage="/images/profile-personal.jpg"
    />

    <!-- Name -->
    <h1
      class="font-cormorant text-4xl font-semibold tracking-wide text-foreground"
      data-mode="professional"
    >
      {t('nameProfessional')}
    </h1>
    <h1
      class="font-cormorant text-4xl font-semibold tracking-wide text-foreground"
      data-mode="personal"
      style="display: none;"
    >
      {t('namePersonal')}
    </h1>
  </section>

  <!-- About - Professional -->
  <About mode="professional">
    <Fragment set:html={t('aboutProfessional')} />
  </About>

  <!-- About - Personal -->
  <About mode="personal">
    <Fragment set:html={t('aboutPersonal')} />
  </About>

  <!-- Posts - Professional -->
  <Posts posts={professionalPosts} mode="professional" lang={lang} />

  <!-- Posts - Personal -->
  <Posts posts={personalPosts} mode="personal" lang={lang} />

  <!-- Projects - Professional -->
  <Projects projects={professionalProjects} mode="professional" lang={lang} />

  <!-- Projects - Personal -->
  <Projects projects={personalProjects} mode="personal" lang={lang} />
</Layout>
