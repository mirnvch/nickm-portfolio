---
import Layout from '../../layouts/Layout.astro';
import { getAllPosts } from '../../data/posts';

const allPosts = getAllPosts();

function formatDate(date: Date): string {
  return new Intl.DateTimeFormat('en-GB', {
    day: 'numeric',
    month: 'short',
    year: 'numeric'
  }).format(date);
}
---

<Layout title="Blog • Nick Mironovich" description="Thoughts on development, AI, automation, and life.">
  <!-- Header -->
  <header class="flex items-center justify-between w-full">
    <a href="/" class="text-muted-foreground hover:text-foreground transition-colors text-sm">
      ← Home
    </a>
  </header>

  <!-- Title -->
  <h1 class="font-cormorant text-4xl font-semibold text-foreground">Blog</h1>

  <!-- Posts List -->
  <section class="flex flex-col gap-y-6">
    {allPosts.map((post) => (
      <article class="flex flex-col gap-y-1">
        <div class="flex items-baseline justify-between gap-4">
          <div class="flex items-center gap-2">
            {post.pinned && (
              <span class="text-gold text-sm" title="Featured">✦</span>
            )}
            <a
              href={`/blog/${post.slug}/`}
              class="font-cormorant text-xl font-semibold text-foreground hover:text-gold transition-colors"
            >
              {post.title}
            </a>
          </div>
          <time
            datetime={post.date.toISOString()}
            class="shrink-0 text-sm text-muted-foreground hidden sm:block"
          >
            {formatDate(post.date)}
          </time>
        </div>
        <div class="flex items-center gap-2 text-sm text-muted-foreground">
          <span>{post.readTime} min read</span>
        </div>
        {post.description && (
          <p class="text-muted-foreground text-sm mt-1">
            {post.description}
          </p>
        )}
      </article>
    ))}
  </section>
</Layout>
